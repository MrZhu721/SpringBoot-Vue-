"use strict";(self["webpackChunkspring_vue_demo"]=self["webpackChunkspring_vue_demo"]||[]).push([[752],{6752:function(e,l,a){a.r(l),a.d(l,{default:function(){return C}});var o=a(6252);const t={style:{padding:"10px"}},s={style:{margin:"10px 0"}},r=(0,o.Uk)("查询"),i=(0,o.Uk)("新增"),d={class:"demo-image__preview"},m=(0,o.Uk)("编辑"),n=(0,o.Uk)("删除"),u=(0,o.Uk)("加入书架"),h=(0,o._)("br",null,null,-1),p={style:{margin:"10px 0"}},c=(0,o.Uk)("点击上传"),g={class:"dialog-footer"},f=(0,o.Uk)("取消"),b=(0,o.Uk)("确定");function w(e,l,a,w,k,_){const y=(0,o.up)("el-input"),W=(0,o.up)("el-button"),C=(0,o.up)("el-table-column"),S=(0,o.up)("el-image"),V=(0,o.up)("el-popconfirm"),v=(0,o.up)("el-table"),U=(0,o.up)("el-pagination"),z=(0,o.up)("el-form-item"),x=(0,o.up)("el-date-picker"),D=(0,o.up)("el-upload"),P=(0,o.up)("el-form"),$=(0,o.up)("el-dialog");return(0,o.wg)(),(0,o.iD)("div",t,[(0,o._)("div",s,[(0,o.Wm)(y,{modelValue:k.search,"onUpdate:modelValue":l[0]||(l[0]=e=>k.search=e),placeholder:"请输入书名关键字",style:{width:"20%"},clearable:""},null,8,["modelValue"]),(0,o.Wm)(W,{type:"primary",style:{"margin-left":"5px"},onClick:_.load},{default:(0,o.w5)((()=>[r])),_:1},8,["onClick"]),1===k.user.role?((0,o.wg)(),(0,o.j4)(W,{key:0,type:"primary",onClick:_.add},{default:(0,o.w5)((()=>[i])),_:1},8,["onClick"])):(0,o.kq)("",!0)]),(0,o.Wm)(v,{data:k.tableData,border:"",stripe:"",style:{width:"calc(100% - 40px)"}},{default:(0,o.w5)((()=>[(0,o.Wm)(C,{prop:"id",label:"ID",sortable:""}),(0,o.Wm)(C,{prop:"name",label:"书名"}),(0,o.Wm)(C,{prop:"price",label:"价格"}),(0,o.Wm)(C,{prop:"author",label:"作者"}),(0,o.Wm)(C,{prop:"createTime",label:"出版日期"}),(0,o.Wm)(C,{label:"封面"},{default:(0,o.w5)((e=>[(0,o._)("div",d,[(0,o.Wm)(S,{style:{width:"100px",height:"100px"},src:e.row.cover,"preview-src-list":[e.row.cover],"preview-teleported":"true"},null,8,["src","preview-src-list"])])])),_:1}),1===k.user.role?((0,o.wg)(),(0,o.j4)(C,{key:0,align:"right",width:"150px"},{default:(0,o.w5)((e=>[(0,o.Wm)(W,{type:"primary",size:"small",onClick:l=>_.handleEdit(e.row)},{default:(0,o.w5)((()=>[m])),_:2},1032,["onClick"]),(0,o.Wm)(V,{title:"该操作不可撤销,你确定要删除它吗?",onConfirm:l=>_.handleDelete(e.row)},{reference:(0,o.w5)((()=>[(0,o.Wm)(W,{size:"small",type:"danger"},{default:(0,o.w5)((()=>[n])),_:1})])),_:2},1032,["onConfirm"])])),_:1})):(0,o.kq)("",!0),2===k.user.role?((0,o.wg)(),(0,o.j4)(C,{key:1,align:"center",width:"150px"},{default:(0,o.w5)((e=>[(0,o.Wm)(W,{type:"primary",size:"small",onClick:l=>_.addBookShelf(e.row)},{default:(0,o.w5)((()=>[u])),_:2},1032,["onClick"]),h])),_:1})):(0,o.kq)("",!0)])),_:1},8,["data"]),(0,o._)("div",p,[(0,o.Wm)(U,{currentPage:k.currentPage4,"onUpdate:currentPage":l[1]||(l[1]=e=>k.currentPage4=e),"page-size":k.pageSize,"onUpdate:page-size":l[2]||(l[2]=e=>k.pageSize=e),"page-sizes":[5,10,15,20],small:e.small,disabled:e.disabled,background:e.background,layout:"total, sizes, prev, pager, next, jumper",total:k.total,onSizeChange:_.handleSizeChange,onCurrentChange:_.handleCurrentChange},null,8,["currentPage","page-size","small","disabled","background","total","onSizeChange","onCurrentChange"])]),(0,o.Wm)($,{modelValue:k.dialogVisible,"onUpdate:modelValue":l[8]||(l[8]=e=>k.dialogVisible=e),title:"填写信息",width:"30%","before-close":e.handleClose},{footer:(0,o.w5)((()=>[(0,o._)("span",g,[(0,o.Wm)(W,{onClick:l[7]||(l[7]=e=>k.dialogVisible=!1)},{default:(0,o.w5)((()=>[f])),_:1}),(0,o.Wm)(W,{type:"primary",onClick:_.save},{default:(0,o.w5)((()=>[b])),_:1},8,["onClick"])])])),default:(0,o.w5)((()=>[(0,o.Wm)(P,{model:k.form,"label-width":"120px"},{default:(0,o.w5)((()=>[(0,o.Wm)(z,{label:"书名"},{default:(0,o.w5)((()=>[(0,o.Wm)(y,{modelValue:k.form.name,"onUpdate:modelValue":l[3]||(l[3]=e=>k.form.name=e),style:{width:"80%",height:"70%"}},null,8,["modelValue"])])),_:1}),(0,o.Wm)(z,{label:"价格"},{default:(0,o.w5)((()=>[(0,o.Wm)(y,{modelValue:k.form.price,"onUpdate:modelValue":l[4]||(l[4]=e=>k.form.price=e),style:{width:"80%",height:"70%"}},null,8,["modelValue"])])),_:1}),(0,o.Wm)(z,{label:"作者"},{default:(0,o.w5)((()=>[(0,o.Wm)(y,{modelValue:k.form.author,"onUpdate:modelValue":l[5]||(l[5]=e=>k.form.author=e),style:{width:"80%",height:"70%"}},null,8,["modelValue"])])),_:1}),(0,o.Wm)(z,{label:"出版日期"},{default:(0,o.w5)((()=>[(0,o.Wm)(x,{"value-format":"YYYY-MM-DD",type:"date",modelValue:k.form.createTime,"onUpdate:modelValue":l[6]||(l[6]=e=>k.form.createTime=e),clearable:"",style:{width:"80%",height:"70%"}},null,8,["modelValue"])])),_:1}),(0,o.Wm)(z,{label:"封面"},{default:(0,o.w5)((()=>[(0,o.Wm)(D,{action:"/api/files/upload","on-success":_.fileUploadSuccess},{default:(0,o.w5)((()=>[(0,o.Wm)(W,{type:"primary"},{default:(0,o.w5)((()=>[c])),_:1})])),_:1},8,["on-success"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","before-close"])])}var k=a(4471),_={name:"Book",components:{},data(){return{user:{},form:{},bookShelf:{},dialogVisible:!1,search:"",currentPage4:1,pageSize:5,total:0,tableData:[]}},created(){let e=sessionStorage.getItem("user")||"{}";this.user=JSON.parse(e),k.Z.get("/user/"+this.user.id).then((e=>{"0"===e.code&&(this.user=e.data)})),this.load()},methods:{fileUploadSuccess(e){console.log(e),this.form.cover=e.data},load(){k.Z.get("/book",{params:{pageNum:this.currentPage4,pageSize:this.pageSize,search:this.search}}).then((e=>{console.log(e),this.tableData=e.data.records,this.total=e.data.total}))},add(){this.dialogVisible=!0,this.form={}},save(){this.dialogVisible=!1,this.form.id?k.Z.put("/book",this.form).then((e=>{console.log(e),"0"===e.code?this.$message.success("修改成功"):this.$message.error(e.message)})):k.Z.post("/book",this.form).then((e=>{console.log(e),"0"===e.code?this.$message.success("添加成功"):this.$message.error(e.message)})),this.load()},handleEdit(e){this.form=JSON.parse(JSON.stringify(e)),console.log(this.form),this.dialogVisible=!0},handleDelete(e){console.log(e.id),k.Z["delete"]("/book/"+e.id).then((e=>{"0"===e.code?this.$message.success("删除成功"):this.$message.error(e.message)})),this.load()},addBookShelf(e){this.form=JSON.parse(JSON.stringify(e)),console.log(this.form,this.user),this.bookShelf.bName=this.form.name,this.bookShelf.bPrice=this.form.price,this.bookShelf.bAuthor=this.form.author,this.bookShelf.bCover=this.form.cover,this.bookShelf.uId=this.user.id,k.Z.post("/bookShelf",this.form).then((e=>{console.log(e),"0"===e.code?this.$message.success("已加入书架"):this.$message.error(e.message)}))},handleSizeChange(){this.load()},handleCurrentChange(){this.load()}}},y=a(3744);const W=(0,y.Z)(_,[["render",w]]);var C=W}}]);
//# sourceMappingURL=752.6c8dfc4f.js.map